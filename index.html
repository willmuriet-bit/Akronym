<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>Akronym</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
        }

        body, html {
            height: 100%;
            width: 100%;
            font-family: 'Arial', sans-serif;
            overflow: hidden;
            position: fixed;
        }

        body {
            background-image: url('background.jpg');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #startPage {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .rotation-container {
            position: relative;
            width: 300px;
            height: 300px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .comet-tail {
            position: absolute;
            width: 300px;
            height: 300px;
            top: 50%;
            left: 50%;
            margin-top: -150px;
            margin-left: -150px;
            animation: rotateOnEdge 20s linear infinite;
            z-index: 15;
            pointer-events: none;
        }

        .comet-tail::before {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: conic-gradient(
                from 0deg,
                rgba(0, 255, 255, 1) 0deg,
                rgba(0, 255, 255, 0.9) 20deg,
                rgba(0, 255, 255, 0.7) 40deg,
                rgba(0, 191, 255, 0.5) 60deg,
                rgba(0, 191, 255, 0.3) 80deg,
                rgba(0, 191, 255, 0.15) 100deg,
                transparent 180deg
            );
            filter: blur(15px);
            transform: rotate(-90deg);
        }

        .comet-tail::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: conic-gradient(
                from 0deg,
                rgba(0, 255, 255, 1) 0deg,
                rgba(0, 255, 255, 0.8) 15deg,
                rgba(0, 191, 255, 0.5) 40deg,
                transparent 90deg
            );
            filter: blur(10px);
            transform: rotate(-90deg);
            opacity: 0.9;        }

        .trail {
            position: absolute;
            width: 100%;
            height: 100%;
            border: 2px dashed rgba(0, 191, 255, 0.5);
            border-radius: 50%;
            box-sizing: border-box;
            z-index: 5;
            box-shadow: 0 0 15px rgba(0, 191, 255, 0.6);
        }

        .start-btn {
            position: relative;
            z-index: 10;
            background: linear-gradient(180deg, #4FD3FF 0%, #00BFFF 40%, #0080FF 100%);
            color: white;
            border: none;
            width: 300px;
            height: 300px;
            border-radius: 50%;
            font-size: 3rem;
            font-weight: bold;
            letter-spacing: 5px;
            cursor: pointer;
            box-shadow: 
                0 10px 30px rgba(0, 0, 0, 0.5),
                0 20px 60px rgba(0, 0, 0, 0.4),
                inset 0 -8px 15px rgba(0, 0, 0, 0.4),
                inset 0 8px 15px rgba(255, 255, 255, 0.5),
                inset 0 0 0 8px rgba(200, 200, 200, 0.8),
                inset 0 0 0 12px rgba(100, 100, 100, 0.6),
                inset 0 0 30px rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
            text-shadow: 0 3px 6px rgba(0, 0, 0, 0.4);
            outline: none;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
            -webkit-user-select: none;
        }

        .start-btn:hover {
            transform: scale(1.02);
            box-shadow: 
                0 12px 35px rgba(0, 0, 0, 0.6),
                0 25px 70px rgba(0, 0, 0, 0.5),
                inset 0 -8px 15px rgba(0, 0, 0, 0.4),
                inset 0 8px 15px rgba(255, 255, 255, 0.6),
                inset 0 0 0 8px rgba(200, 200, 200, 0.9),                inset 0 0 0 12px rgba(100, 100, 100, 0.7),
                inset 0 0 40px rgba(255, 255, 255, 0.4);
        }

        .start-btn:active {
            transform: scale(0.98);
        }

        .start-btn:focus,
        .start-btn:focus-visible {
            outline: none;
        }

        @keyframes rotateOnEdge {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        #keyboardPage {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('background.jpg');
            background-size: cover;
            background-position: center;
            z-index: 100;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            padding: 5px;
        }

        #displayArea {
            width: 95vw;
            max-width: 700px;
            min-height: 220px;
            background: rgba(0, 0, 0, 0.7);
            border: 3px solid rgba(0, 191, 255, 0.6);
            border-radius: 15px;
            margin: 10px 0;
            padding: 20px 25px;
            font-size: 5rem;
            color: #00FFFF;
            text-align: center;
            box-shadow: 0 0 40px rgba(0, 191, 255, 0.4);
            display: flex;
            align-items: center;            justify-content: center;
            flex-wrap: nowrap;
            gap: 5px;
            line-height: 1;
            overflow-x: auto;
            overflow-y: hidden;
        }

        .display-card {
            font-size: clamp(7.5rem, 14vw, 11rem);
            display: inline-block;
            line-height: 1;
            min-width: 0;
            flex-shrink: 0;
            white-space: nowrap;
            user-select: none;
            -webkit-user-select: none;
        }

        .display-card[data-suit="‚ô•"],
        .display-card[data-suit="‚ô¶"] {
            color: #FF0000;
        }

        .display-card[data-suit="‚ô†"],
        .display-card[data-suit="‚ô£"] {
            color: #FFFFFF;
        }

        .display-card.last-card {
            cursor: pointer;
            filter: brightness(1.3);
            transition: all 0.2s ease;
        }

        .display-card.last-card:hover {
            transform: scale(1.1);
            filter: brightness(1.5);
        }

        .display-card.last-card:active {
            transform: scale(0.9);
        }

        .keyboard-container {
            background: rgba(0, 0, 0, 0.6);
            padding: 15px;
            border-radius: 15px;
            border: 2px solid rgba(0, 191, 255, 0.4);
            box-shadow: 0 0 50px rgba(0, 191, 255, 0.3);            width: 95vw;
            max-width: 700px;
        }

        .keyboard-row {
            display: flex;
            justify-content: center;
            margin-bottom: 10px;
            gap: 10px;
            flex-wrap: wrap;
        }

        .key {
            background: rgba(0, 0, 0, 0.8);
            border: 2px solid #00BFFF;
            border-radius: 50%;
            color: white;
            font-size: 2.8rem;
            font-weight: bold;
            width: 80px;
            height: 80px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 0 15px rgba(0, 191, 255, 0.3);
            position: relative;
            overflow: hidden;
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            outline: none;
            -webkit-tap-highlight-color: transparent;
            -webkit-focus-ring-color: transparent;
        }

        .key::before {
            content: '';
            position: absolute;
            width: 150%;
            height: 150%;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(0, 191, 255, 0.7) 0%, rgba(0, 191, 255, 0.3) 40%, transparent 70%);
            opacity: 0;
            transform: scale(0.3);
            transition: all 0.3s ease;
        }

        .key:hover::before {            opacity: 1;
            transform: scale(1);
        }

        .key:hover {
            transform: scale(1.1);
            box-shadow: 0 0 40px rgba(0, 191, 255, 0.8), 0 0 60px rgba(0, 191, 255, 0.5);
        }

        .key:active {
            transform: scale(0.95);
        }

        .key:focus,
        .key:focus-visible {
            outline: none;
            box-shadow: 0 0 15px rgba(0, 191, 255, 0.3);
        }

        .key.active-x {
            animation: pulseBlue 2s infinite;
        }

        .key.active-x::before {
            opacity: 1;
            transform: scale(1);
        }

        .key.active-x {
            box-shadow: 0 0 40px rgba(0, 191, 255, 0.8), 0 0 60px rgba(0, 191, 255, 0.5);
        }

        @keyframes pulseBlue {
            0%, 100% {
                box-shadow: 0 0 40px rgba(0, 191, 255, 0.8), 0 0 60px rgba(0, 191, 255, 0.5);
            }
            50% {
                box-shadow: 0 0 60px rgba(0, 191, 255, 1), 0 0 80px rgba(0, 191, 255, 0.7);
            }
        }

        .key.suit {
            font-size: 3.5rem;
        }

        .key.suit::before {
            content: '';
            position: absolute;
            width: 150%;
            height: 150%;            border-radius: 50%;
            opacity: 0;
            transform: scale(0.3);
            transition: all 0.1s ease;
        }

        .key.suit:not(.hearts):not(.diamonds)::before {
            background: radial-gradient(circle, rgba(255, 255, 255, 0.9) 0%, rgba(255, 255, 255, 0.5) 40%, transparent 70%);
        }

        .key.suit:not(.hearts):not(.diamonds):active::before {
            opacity: 1;
            transform: scale(1);
        }

        .key.suit:not(.hearts):not(.diamonds):active {
            transform: scale(0.95);
            box-shadow: 0 0 40px rgba(255, 255, 255, 0.9), 0 0 60px rgba(255, 255, 255, 0.6);
        }

        .key.hearts::before {
            background: radial-gradient(circle, rgba(255, 0, 0, 0.9) 0%, rgba(255, 0, 0, 0.5) 40%, transparent 70%);
        }

        .key.hearts:active::before {
            opacity: 1;
            transform: scale(1);
        }

        .key.hearts:active {
            transform: scale(0.95);
            box-shadow: 0 0 40px rgba(255, 0, 0, 0.9), 0 0 60px rgba(255, 0, 0, 0.6);
        }

        .key.diamonds::before {
            background: radial-gradient(circle, rgba(255, 0, 0, 0.9) 0%, rgba(255, 0, 0, 0.5) 40%, transparent 70%);
        }

        .key.diamonds:active::before {
            opacity: 1;
            transform: scale(1);
        }

        .key.diamonds:active {
            transform: scale(0.95);
            box-shadow: 0 0 40px rgba(255, 0, 0, 0.9), 0 0 60px rgba(255, 0, 0, 0.6);
        }

        .key.active-y {
            animation: pulseY 2s infinite;        }

        .key.active-y::before {
            opacity: 1;
            transform: scale(1);
        }

        @keyframes pulseY {
            0%, 100% {
                box-shadow: 0 0 40px rgba(255, 255, 255, 0.8), 0 0 60px rgba(255, 255, 255, 0.5);
            }
            50% {
                box-shadow: 0 0 60px rgba(255, 255, 255, 1), 0 0 80px rgba(255, 255, 255, 0.7);
            }
        }

        .key.hearts.active-y {
            animation: pulseYRed 2s infinite;
        }

        @keyframes pulseYRed {
            0%, 100% {
                box-shadow: 0 0 40px rgba(255, 0, 0, 0.8), 0 0 60px rgba(255, 0, 0, 0.5);
            }
            50% {
                box-shadow: 0 0 60px rgba(255, 0, 0, 1), 0 0 80px rgba(255, 0, 0, 0.7);
            }
        }

        .key.hearts {
            color: #FF0000;
            border-color: #FF0000;
            box-shadow: 0 0 15px rgba(255, 0, 0, 0.3);
        }

        .key.diamonds {
            color: #FF0000;
            border-color: #FF0000;
            box-shadow: 0 0 15px rgba(255, 0, 0, 0.3);
        }

        .key.predict {
            width: 180px;
            border-radius: 40px;
            font-size: 2rem;
            background: linear-gradient(180deg, rgba(0, 255, 100, 0.3) 0%, rgba(0, 200, 80, 0.3) 100%);
            border-color: #00FF64;
            color: #00FF64;
            transition: all 0.5s ease;
            pointer-events: none;            opacity: 0.5;
            cursor: not-allowed;
        }

        .key.predict.predict-giant {
            font-size: 3rem;
        }

        .key.predict.predict-active {
            background: linear-gradient(180deg, rgba(0, 255, 100, 0.6) 0%, rgba(0, 200, 80, 0.6) 100%);
            box-shadow: 0 0 40px rgba(0, 255, 100, 0.8), 0 0 60px rgba(0, 255, 100, 0.5);
            animation: pulsePredict 1.5s infinite;
            pointer-events: auto;
            opacity: 1;
            cursor: pointer;
        }

        @keyframes pulsePredict {
            0%, 100% {
                box-shadow: 0 0 40px rgba(0, 255, 100, 0.8), 0 0 60px rgba(0, 255, 100, 0.5);
            }
            50% {
                box-shadow: 0 0 60px rgba(0, 255, 100, 1), 0 0 80px rgba(0, 255, 100, 0.7);
            }
        }

        .key.predict::before {
            background: radial-gradient(ellipse, rgba(0, 255, 100, 0.7) 0%, rgba(0, 255, 100, 0.3) 40%, transparent 70%);
        }

        .key.predict:hover {
            background: linear-gradient(180deg, rgba(0, 255, 100, 0.5) 0%, rgba(0, 200, 80, 0.5) 100%);
            box-shadow: 0 0 40px rgba(0, 255, 100, 0.8), 0 0 60px rgba(0, 255, 100, 0.5);
        }

        #predictPage {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('background.jpg');
            background-size: cover;
            background-position: center;
            z-index: 200;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        .loading-container {
            position: relative;
            width: 200px;
            height: 200px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .loading-ring {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 4px solid transparent;
            border-top-color: #00FFFF;
            border-right-color: #00BFFF;
            animation: spin 1s linear infinite;
        }

        .loading-ring:nth-child(2) {
            width: 70%;
            height: 70%;
            border-top-color: #00FF64;
            border-right-color: #00FFFF;
            animation: spin 1.5s linear infinite reverse;
        }

        .loading-ring:nth-child(3) {
            width: 40%;
            height: 40%;
            border-top-color: #FFD700;
            border-right-color: #00FF64;
            animation: spin 2s linear infinite;
        }

        .loading-particles {
            position: absolute;
            width: 100%;
            height: 100%;
            animation: spin 3s linear infinite;
        }

        .particle {
            position: absolute;
            width: 8px;
            height: 8px;
            background: #00FFFF;
            border-radius: 50%;            box-shadow: 0 0 10px #00FFFF, 0 0 20px #00BFFF;
        }

        .particle:nth-child(1) { top: 0; left: 50%; animation: particleFloat 1s ease-in-out infinite; }
        .particle:nth-child(2) { top: 25%; right: 10%; animation: particleFloat 1.2s ease-in-out infinite 0.2s; background: #00FF64; }
        .particle:nth-child(3) { bottom: 25%; left: 10%; animation: particleFloat 1.4s ease-in-out infinite 0.4s; background: #FFD700; }
        .particle:nth-child(4) { bottom: 0; left: 50%; animation: particleFloat 1.1s ease-in-out infinite 0.6s; background: #00BFFF; }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        @keyframes particleFloat {
            0%, 100% { opacity: 0.3; transform: scale(0.5); }
            50% { opacity: 1; transform: scale(1.2); }
        }

        .card-flip-container {
            display: block;
            width: 300px;
            height: 450px;
            perspective: 1000px;
            cursor: pointer;
            animation: zoomBreath 3s ease-in-out infinite;
            margin: 0 auto;
            position: relative;
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
            outline: none;
        }

        .card-flip-inner {
            position: relative;
            width: 100%;
            height: 100%;
            transition: transform 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            transform-style: preserve-3d;
            user-select: none;
            -webkit-user-select: none;
            -webkit-tap-highlight-color: transparent;
            outline: none;
        }

        .card-emoji {
            position: absolute;            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 33rem;
            backface-visibility: hidden;
            -webkit-backface-visibility: hidden;
            background: transparent;
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            -webkit-touch-callout: none;
            -webkit-tap-highlight-color: transparent;
            outline: none;
        }

        .card-emoji.back {
            color: #00FFFF;
        }

        .card-emoji.face {
            color: #FF0000;
            transform: rotateY(180deg);
        }

        @keyframes zoomBreath {
            0%, 100% { 
                transform: scale(1);
                opacity: 0.9;
            }
            50% { 
                transform: scale(1.15);
                opacity: 1;
            }
        }

        @media (max-width: 400px) {
            .key {
                width: min(80px, 18vw);
                height: min(80px, 18vw);
                font-size: min(2.8rem, 5vw);
            }
            .key.suit { font-size: min(3.5rem, 7vw); }
            .key.predict { width: min(180px, 40vw); font-size: min(2rem, 4vw); }
            .key.predict.predict-giant { font-size: min(3rem, 6vw); }
            #displayArea { min-height: 220px; gap: 5px; padding: 20px 25px; }
            .display-card { font-size: clamp(7.5rem, 14vw, 11rem); }
            .card-flip-container { width: 250px; height: 375px; }            .card-emoji { font-size: 27rem; }
        }
    </style>
</head>
<body>
    <div id="startPage">
        <div class="rotation-container">
            <div class="trail"></div>
            <button class="start-btn" id="startBtn">START</button>
            <div class="comet-tail" id="cometTail"></div>
        </div>
    </div>

    <div id="keyboardPage">
        <div id="displayArea"></div>
        
        <div class="keyboard-container">
            <div class="keyboard-row">
                <button class="key suit" data-suit="‚ô†" onclick="addChar('‚ô†')">‚ô†</button>
                <button class="key suit hearts" data-suit="‚ô•" onclick="addChar('‚ô•')">‚ô•</button>
                <button class="key suit" data-suit="‚ô£" onclick="addChar('‚ô£')">‚ô£</button>
                <button class="key suit diamonds" data-suit="‚ô¶" onclick="addChar('‚ô¶')">‚ô¶</button>
            </div>

            <div class="keyboard-row">
                <button class="key value-btn" data-value="A" onclick="addChar('A')">A</button>
                <button class="key value-btn" data-value="2" onclick="addChar('2')">2</button>
                <button class="key value-btn" data-value="3" onclick="addChar('3')">3</button>
                <button class="key value-btn" data-value="4" onclick="addChar('4')">4</button>
            </div>

            <div class="keyboard-row">
                <button class="key value-btn" data-value="5" onclick="addChar('5')">5</button>
                <button class="key value-btn" data-value="6" onclick="addChar('6')">6</button>
                <button class="key value-btn" data-value="7" onclick="addChar('7')">7</button>
                <button class="key value-btn" data-value="8" onclick="addChar('8')">8</button>
            </div>

            <div class="keyboard-row">
                <button class="key value-btn" data-value="9" onclick="addChar('9')">9</button>
                <button class="key value-btn" data-value="10" onclick="addChar('10')">10</button>
                <button class="key value-btn" data-value="J" onclick="addChar('J')">J</button>
                <button class="key value-btn" data-value="Q" onclick="addChar('Q')">Q</button>
            </div>

            <div class="keyboard-row">
                <button class="key value-btn" data-value="K" onclick="addChar('K')">K</button>
                <button class="key predict" id="predictBtn" onclick="predict()">PREDICT</button>
            </div>
        </div>    </div>

    <div id="predictPage">
        <div class="loading-container" id="loadingContainer">
            <div class="loading-ring"></div>
            <div class="loading-ring"></div>
            <div class="loading-ring"></div>
            <div class="loading-particles">
                <div class="particle"></div>
                <div class="particle"></div>
                <div class="particle"></div>
                <div class="particle"></div>
            </div>
        </div>
        
        <div class="card-flip-container" id="cardFlipContainer" onclick="flipCard()">
            <div class="card-flip-inner" id="cardFlipInner">
                <div class="card-emoji back" id="cardBack">üÇ†</div>
                <div class="card-emoji face" id="cardFace">üÉä</div>
            </div>
        </div>
    </div>

    <script>
        // ============================================
        // ‚úÖ VARIABLES GLOBALES
        // ============================================
        var savedCards = [];
        var currentX = null;
        var currentY = null;
        var maxSavedCards = 4;
        var values = ['A', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K'];
        var suits = ['‚ô†', '‚ô•', '‚ô£', '‚ô¶'];
        var cometTailRotation = 0;
        var startRotation = 0;
        var isFlipped = false;
        var isFlipping = false;
        var stock = [];
        var reveal = '10‚ô¶';
        var lastTapTime = 0;

        // ============================================
        // ‚úÖ BASIC ORDER (52 CARTES)
        // ============================================
        var basicOrder = [
            'A‚ô†', 'A‚ô•', 'A‚ô£', 'A‚ô¶',
            '2‚ô†', '2‚ô•', '2‚ô£', '2‚ô¶',
            '3‚ô†', '3‚ô•', '3‚ô£', '3‚ô¶',
            '4‚ô†', '4‚ô•', '4‚ô£', '4‚ô¶',
            '5‚ô†', '5‚ô•', '5‚ô£', '5‚ô¶',            '6‚ô†', '6‚ô•', '6‚ô£', '6‚ô¶',
            '7‚ô†', '7‚ô•', '7‚ô£', '7‚ô¶',
            '8‚ô†', '8‚ô•', '8‚ô£', '8‚ô¶',
            '9‚ô†', '9‚ô•', '9‚ô£', '9‚ô¶',
            '10‚ô†', '10‚ô•', '10‚ô£', '10‚ô¶',
            'J‚ô†', 'J‚ô•', 'J‚ô£', 'J‚ô¶',
            'Q‚ô†', 'Q‚ô•', 'Q‚ô£', 'Q‚ô¶',
            'K‚ô†', 'K‚ô•', 'K‚ô£', 'K‚ô¶'
        ];

        // ============================================
        // ‚úÖ HIGHCARDS (7‚ô† √† Q‚ô¶)
        // ============================================
        var highcards = {
            '7‚ô†': '4321', '7‚ô•': '3421', '7‚ô£': '2431', '7‚ô¶': '1432',
            '8‚ô†': '4213', '8‚ô•': '3214', '8‚ô£': '2314', '8‚ô¶': '1324',
            '9‚ô†': '4132', '9‚ô•': '3142', '9‚ô£': '2143', '9‚ô¶': '1243',
            '10‚ô†': '4312', '10‚ô•': '3412', '10‚ô£': '2413', '10‚ô¶': '1423',
            'J‚ô†': '4231', 'J‚ô•': '3241', 'J‚ô£': '2341', 'J‚ô¶': '1342',
            'Q‚ô†': '4123', 'Q‚ô•': '3124', 'Q‚ô£': '2134', 'Q‚ô¶': '1234'
        };

        // ============================================
        // ‚úÖ LOWCARDS (A‚ô† √† 6‚ô¶)
        // ============================================
        var lowcards = {
            'A‚ô†': '4321', 'A‚ô•': '3421', 'A‚ô£': '2431', 'A‚ô¶': '1432',
            '2‚ô†': '4213', '2‚ô•': '3214', '2‚ô£': '2314', '2‚ô¶': '1324',
            '3‚ô†': '4132', '3‚ô•': '3142', '3‚ô£': '2143', '3‚ô¶': '1243',
            '4‚ô†': '4312', '4‚ô•': '3412', '4‚ô£': '2413', '4‚ô¶': '1423',
            '5‚ô†': '4231', '5‚ô•': '3241', '5‚ô£': '2341', '5‚ô¶': '1342',
            '6‚ô†': '4123', '6‚ô•': '3124', '6‚ô£': '2134', '6‚ô¶': '1234'
        };

        // ============================================
        // ‚úÖ EMOJIS CARTES
        // ============================================
        var cardEmojis = {
            'A‚ô†': 'üÇ°', 'A‚ô•': 'üÇ±', 'A‚ô£': 'üÉë', 'A‚ô¶': 'üÉÅ',
            '2‚ô†': 'üÇ¢', '2‚ô•': 'üÇ≤', '2‚ô£': 'üÉí', '2‚ô¶': 'üÉÇ',
            '3‚ô†': 'üÇ£', '3‚ô•': 'üÇ≥', '3‚ô£': 'üÉì', '3‚ô¶': 'üÉÉ',
            '4‚ô†': 'üÇ§', '4‚ô•': 'üÇ¥', '4‚ô£': 'üÉî', '4‚ô¶': 'üÉÑ',
            '5‚ô†': 'üÇ•', '5‚ô•': 'üÇµ', '5‚ô£': 'üÉï', '5‚ô¶': 'üÉÖ',
            '6‚ô†': 'üÇ¶', '6‚ô•': 'üÇ∂', '6‚ô£': 'üÉñ', '6‚ô¶': 'üÉÜ',
            '7‚ô†': 'üÇß', '7‚ô•': 'üÇ∑', '7‚ô£': 'üÉó', '7‚ô¶': 'üÉá',
            '8‚ô†': 'üÇ®', '8‚ô•': 'üÇ∏', '8‚ô£': 'üÉò', '8‚ô¶': 'üÉà',
            '9‚ô†': 'üÇ©', '9‚ô•': 'üÇπ', '9‚ô£': 'üÉô', '9‚ô¶': 'üÉâ',
            '10‚ô†': 'üÇ™', '10‚ô•': 'üÇ∫', '10‚ô£': 'üÉö', '10‚ô¶': 'üÉä',
            'J‚ô†': 'üÇ´', 'J‚ô•': 'üÇª', 'J‚ô£': 'üÉõ', 'J‚ô¶': 'üÉã',
            'Q‚ô†': 'üÇ≠', 'Q‚ô•': 'üÇΩ', 'Q‚ô£': 'üÉù', 'Q‚ô¶': 'üÉç',            'K‚ô†': 'üÇ¨', 'K‚ô•': 'üÇº', 'K‚ô£': 'üÉú', 'K‚ô¶': 'üÉå'
        };

        // ============================================
        // ‚úÖ INITIALISATION AU CHARGEMENT
        // ============================================
        window.addEventListener('load', function() {
            console.log('‚úÖ Page charg√©e - Initialisation...');
            initStartButton();
            initDoubleTap();
            trackCometRotation();
        });

        // ============================================
        // ‚úÖ INITIALISATION BOUTON START
        // ============================================
        function initStartButton() {
            var startBtn = document.getElementById('startBtn');
            if (startBtn) {
                startBtn.addEventListener('click', goToKeyboard);
                console.log('‚úÖ Bouton START initialis√©');
            } else {
                console.error('‚ùå Bouton START non trouv√©!');
            }
        }

        // ============================================
        // ‚úÖ INITIALISATION DOUBLE-TAP (300ms)
        // ============================================
        function initDoubleTap() {
            var predictPage = document.getElementById('predictPage');
            if (predictPage) {
                predictPage.addEventListener('click', handleDoubleTap);
                console.log('‚úÖ Double-tap initialis√© sur predictPage');
            }
        }

        // ============================================
        // ‚úÖ GESTION DOUBLE-TAP
        // ============================================
        function handleDoubleTap(e) {
            var currentTime = new Date().getTime();
            var tapLength = currentTime - lastTapTime;
            
            if (tapLength < 300 && tapLength > 0) {
                e.preventDefault();
                exitToStart();
                lastTapTime = 0;
            } else {
                lastTapTime = currentTime;            }
        }

        // ============================================
        // ‚úÖ SUIVI ROTATION COM√àTE
        // ============================================
        function trackCometRotation() {
            var cometTail = document.getElementById('cometTail');
            if (cometTail) {
                var style = window.getComputedStyle(cometTail);
                var matrix = style.transform;
                if (matrix !== 'none') {
                    var values_matrix = matrix.split('(')[1].split(')')[0].split(',');
                    var a = values_matrix[0];
                    var b = values_matrix[1];
                    var angleInRadians = Math.atan2(b, a);
                    cometTailRotation = (angleInRadians * (180 / Math.PI) + 360) % 360;
                }
            }
            requestAnimationFrame(trackCometRotation);
        }

        // ============================================
        // ‚úÖ ALLER VERS CLAVIER
        // ============================================
        function goToKeyboard() {
            console.log('üéØ goToKeyboard() appel√©');
            
            var startPage = document.getElementById('startPage');
            var keyboardPage = document.getElementById('keyboardPage');
            var predictBtn = document.getElementById('predictBtn');
            
            if (!startPage || !keyboardPage) {
                console.error('‚ùå Pages non trouv√©es!');
                return;
            }
            
            if (predictBtn) {
                if (cometTailRotation >= 0 && cometTailRotation < 180) {
                    predictBtn.classList.add('predict-giant');
                } else {
                    predictBtn.classList.remove('predict-giant');
                }
            }
            
            startPage.style.display = 'none';
            keyboardPage.style.display = 'flex';
            
            savedCards = [];
            currentX = null;            currentY = null;
            isFlipped = false;
            isFlipping = false;
            stock = [];
            reveal = '10‚ô¶';
            
            updateXButtonAnimation();
            updateYButtonAnimation();
            updateDisplay();
            updatePredictButton();
            
            console.log('‚úÖ Navigation vers clavier r√©ussie');
        }

        // ============================================
        // ‚úÖ ANIMATION BOUTONS X
        // ============================================
        function updateXButtonAnimation() {
            var allValueBtns = document.querySelectorAll('.value-btn');
            for (var i = 0; i < allValueBtns.length; i++) {
                allValueBtns[i].classList.remove('active-x');
            }
            
            if (currentX !== null) {
                var activeBtn = document.querySelector('.value-btn[data-value="' + currentX + '"]');
                if (activeBtn) {
                    activeBtn.classList.add('active-x');
                }
            }
        }

        // ============================================
        // ‚úÖ ANIMATION BOUTONS Y
        // ============================================
        function updateYButtonAnimation() {
            var allSuitBtns = document.querySelectorAll('.key.suit');
            for (var i = 0; i < allSuitBtns.length; i++) {
                allSuitBtns[i].classList.remove('active-y');
            }
            
            if (currentY !== null) {
                var activeBtn = document.querySelector('.key.suit[data-suit="' + currentY + '"]');
                if (activeBtn) {
                    activeBtn.classList.add('active-y');
                }
            }
        }

        // ============================================
        // ‚úÖ BOUTON PREDICT        // ============================================
        function updatePredictButton() {
            var predictBtn = document.getElementById('predictBtn');
            if (!predictBtn) return;
            
            var displayedCards = [];
            
            for (var i = 0; i < Math.min(savedCards.length, maxSavedCards); i++) {
                displayedCards.push(savedCards[i]);
            }
            
            if (currentX !== null && currentY !== null && displayedCards.length < maxSavedCards) {
                displayedCards.push(currentX + currentY);
            }
            
            var hasFourCards = (displayedCards.length === 4);
            
            var allDifferent = true;
            var uniqueCards = {};
            for (var i = 0; i < displayedCards.length; i++) {
                if (uniqueCards[displayedCards[i]]) {
                    allDifferent = false;
                    break;
                }
                uniqueCards[displayedCards[i]] = true;
            }
            
            if (hasFourCards && allDifferent) {
                predictBtn.classList.add('predict-active');
            } else {
                predictBtn.classList.remove('predict-active');
            }
        }

        // ============================================
        // ‚úÖ AFFICHAGE CARTES
        // ============================================
        function updateDisplay() {
            var display = document.getElementById('displayArea');
            if (!display) return;
            
            var newContent = '';
            var numToShow = Math.min(savedCards.length, maxSavedCards);
            
            for (var i = 0; i < numToShow; i++) {
                var cardKey = savedCards[i];
                var cardEmoji = cardEmojis[cardKey] || cardKey;
                var suit = cardKey.slice(-1);
                newContent += '<span class="display-card" data-suit="' + suit + '">' + cardEmoji + '</span>';
            }
            if (currentX !== null && currentY !== null && savedCards.length < maxSavedCards) {
                var currentCard = currentX + currentY;
                var currentEmoji = cardEmojis[currentCard] || currentCard;
                var isDuplicate = (savedCards.indexOf(currentCard) >= 0);
                var suit = currentCard.slice(-1);
                
                if (isDuplicate) {
                    newContent += '<span class="display-card last-card" data-suit="' + suit + '" style="filter: brightness(0.5);">' + currentEmoji + '</span>';
                } else {
                    newContent += '<span class="display-card last-card" data-suit="' + suit + '">' + currentEmoji + '</span>';
                }
            }

            display.innerHTML = newContent;
            attachClickListeners();
        }

        // ============================================
        // ‚úÖ GESTION CLICS CARTES
        // ============================================
        function attachClickListeners() {
            var display = document.getElementById('displayArea');
            if (!display) return;
            
            var allCards = display.querySelectorAll('.display-card');
            
            for (var i = 0; i < allCards.length; i++) {
                allCards[i].classList.remove('last-card');
                allCards[i].onclick = null;
                allCards[i].ontouchstart = null;
            }
            
            if (allCards.length > 0) {
                var lastCard = allCards[allCards.length - 1];
                lastCard.classList.add('last-card');
                lastCard.onclick = deleteLastCard;
                lastCard.ontouchstart = function(e) {
                    e.preventDefault();
                    deleteLastCard();
                };
            }
        }

        // ============================================
        // ‚úÖ SUPPRIMER DERNI√àRE CARTE
        // ============================================
        function deleteLastCard() {
            if (currentX !== null && currentY !== null) {
            } else if (savedCards.length > 0) {                savedCards.pop();
            }
            
            currentX = null;
            currentY = null;
            updateXButtonAnimation();
            updateYButtonAnimation();
            updatePredictButton();
            updateDisplay();
        }

        // ============================================
        // ‚úÖ AJOUTER CARACT√àRE
        // ============================================
        function addChar(char) {
            if (values.indexOf(char) >= 0) {
                if (currentX !== null && currentY !== null) {
                    var cardKey = currentX + currentY;
                    if (savedCards.indexOf(cardKey) < 0 && savedCards.length < maxSavedCards) {
                        savedCards.push(cardKey);
                    }
                }
                currentX = char;
                currentY = null;
                
                updateXButtonAnimation();
                updateYButtonAnimation();
                updatePredictButton();
                updateDisplay();
                
            } else if (suits.indexOf(char) >= 0) {
                if (currentX !== null) {
                    currentY = char;
                    updateXButtonAnimation();
                    updateYButtonAnimation();
                    updatePredictButton();
                    updateDisplay();
                }
            }
        }

        // ============================================
        // ‚úÖ ‚úÖ ‚úÖ CALCULER LE CODE (SANS INVERSION)
        // ============================================
        function calculateCode() {
            console.log('üîê calculateCode() appel√©');
            console.log('üì¶ savedCards:', savedCards);
            console.log('üì¶ currentX:', currentX, 'currentY:', currentY);
            
            // 1. Cr√©er le stock (ordre d'affichage)            stock = [];
            
            // Ajouter les cartes sauvegard√©es
            for (var i = 0; i < Math.min(savedCards.length, maxSavedCards); i++) {
                stock.push(savedCards[i]);
            }
            
            // ‚úÖ AJOUTER LA CARTE EN COURS (currentX + currentY)
            if (currentX !== null && currentY !== null && stock.length < 4) {
                stock.push(currentX + currentY);
                console.log('‚ûï Carte en cours ajout√©e au stock:', currentX + currentY);
            }
            
            console.log('üì¶ STOCK FINAL:', stock);
            
            // 2. Trouver la position de chaque carte dans basicOrder
            var cardPositions = [];
            for (var i = 0; i < stock.length; i++) {
                var position = basicOrder.indexOf(stock[i]);
                cardPositions.push({
                    card: stock[i],
                    position: position,
                    index: i
                });
                console.log('üìç Position de', stock[i], '=', position);
            }
            
            // 3. Trier par position croissante
            cardPositions.sort(function(a, b) {
                return a.position - b.position;
            });
            
            // 4. Attribuer les num√©ros 1-4
            var cardNumbers = {};
            for (var i = 0; i < cardPositions.length; i++) {
                cardNumbers[cardPositions[i].card] = i + 1;
            }
            
            // 5. Cr√©er le code dans l'ordre du stock
            var codeArray = [];
            for (var i = 0; i < stock.length; i++) {
                codeArray.push(cardNumbers[stock[i]]);
            }
            
            // 6. ‚úÖ PAS D'INVERSION - On garde l'ordre du stock
            // codeArray.reverse(); ‚Üê SUPPRIM√â
            
            // 7. Retourner le code en string
            var code = codeArray.join('');
            console.log('üîê Code calcul√©:', code);            return code;
        }

        // ============================================
        // ‚úÖ D√âTERMINER REVEAL
        // ============================================
        function determineReveal(code) {
            console.log('üéØ D√©termination de reveal avec code:', code);
            
            // 1. Choisir la liste selon startRotation
            var liste = (startRotation >= 0 && startRotation < 180) ? highcards : lowcards;
            var listeName = (startRotation >= 0 && startRotation < 180) ? 'HIGHCARDS' : 'LOWCARDS';
            console.log('üìã Liste choisie:', listeName, '(rotation:', startRotation, '¬∞)');
            
            // 2. Trouver la carte avec ce code
            var carteTrouvee = null;
            for (var carte in liste) {
                if (liste[carte] === code) {
                    carteTrouvee = carte;
                    break;
                }
            }
            
            console.log('üîç Carte trouv√©e:', carteTrouvee);
            
            // 3. V√©rifier si la carte n'est pas dans le stock
            if (carteTrouvee && stock.indexOf(carteTrouvee) === -1) {
                reveal = carteTrouvee;
                console.log('‚úÖ reveal d√©fini:', reveal);
            } else {
                reveal = '10‚ô¶';
                console.log('‚ö†Ô∏è Carte dans stock ou inexistante ‚Üí fallback 10‚ô¶');
            }
        }

        // ============================================
        // ‚úÖ PREDICT
        // ============================================
        function predict() {
            console.log('üîÆ predict() appel√©');
            
            var displayedCards = [];
            for (var i = 0; i < Math.min(savedCards.length, maxSavedCards); i++) {
                displayedCards.push(savedCards[i]);
            }
            if (currentX !== null && currentY !== null && displayedCards.length < maxSavedCards) {
                displayedCards.push(currentX + currentY);
            }
            
            var hasFourCards = (displayedCards.length === 4);            var allDifferent = true;
            var uniqueCards = {};
            for (var i = 0; i < displayedCards.length; i++) {
                if (uniqueCards[displayedCards[i]]) {
                    allDifferent = false;
                    break;
                }
                uniqueCards[displayedCards[i]] = true;
            }
            
            if (!hasFourCards || !allDifferent) {
                console.log('‚ùå PREDICT refus√©');
                return;
            }
            
            // ‚úÖ ENREGISTRER startRotation
            startRotation = cometTailRotation;
            console.log('üìç startRotation enregistr√©e:', startRotation, '¬∞');
            
            // ‚úÖ CALCULER LE CODE
            var code = calculateCode();
            
            // ‚úÖ D√âTERMINER REVEAL
            determineReveal(code);
            
            // ‚úÖ NAVIGATION VERS PAGE PREDICT
            document.getElementById('keyboardPage').style.display = 'none';
            document.getElementById('predictPage').style.display = 'flex';
            
            document.getElementById('loadingContainer').style.display = 'flex';
            document.getElementById('cardFlipContainer').style.display = 'none';
            
            // ‚úÖ R√âINITIALISER LA CARTE
            isFlipped = false;
            isFlipping = false;
            document.getElementById('cardFlipInner').style.transform = 'rotateY(0deg)';
            document.getElementById('cardBack').style.display = 'flex';
            document.getElementById('cardFace').style.display = 'none';
            
            setTimeout(function() {
                document.getElementById('loadingContainer').style.display = 'none';
                document.getElementById('cardFlipContainer').style.display = 'block';
                
                // ‚úÖ METTRE √Ä JOUR L'EMOJI DE REVEAL
                var revealEmoji = cardEmojis[reveal] || 'üÉä';
                var revealSuit = reveal.slice(-1);
                var cardFace = document.getElementById('cardFace');
                cardFace.textContent = revealEmoji;
                
                // ‚úÖ D√âFINIR LA COULEUR SELON L'ENSEIGNE                if (revealSuit === '‚ô•' || revealSuit === '‚ô¶') {
                    cardFace.style.color = '#FF0000';
                } else {
                    cardFace.style.color = '#FFFFFF';
                }
                
                console.log('üé¥ reveal emoji affich√©:', revealEmoji, '(', reveal, ')');
            }, 4000);
        }

        // ============================================
        // ‚úÖ FLIP CARTE
        // ============================================
        function flipCard() {
            if (isFlipping) return;
            
            var cardInner = document.getElementById('cardFlipInner');
            var cardBack = document.getElementById('cardBack');
            var cardFace = document.getElementById('cardFace');
            
            isFlipping = true;
            
            if (!isFlipped) {
                cardInner.style.transform = 'rotateY(180deg)';
                
                setTimeout(function() {
                    cardBack.style.display = 'none';
                    cardFace.style.display = 'flex';
                }, 400);
                
                isFlipped = true;
            } else {
                cardInner.style.transform = 'rotateY(0deg)';
                
                setTimeout(function() {
                    cardFace.style.display = 'none';
                    cardBack.style.display = 'flex';
                }, 400);
                
                isFlipped = false;
            }
            
            setTimeout(function() {
                isFlipping = false;
            }, 800);
            
            console.log('üÉè Carte retourn√©e ! isFlipped:', isFlipped);
        }

        // ============================================        // ‚úÖ EXIT VERS START (DOUBLE-TAP)
        // ============================================
        function exitToStart() {
            console.log('üîÑ Double-tap d√©tect√© - Retour √† START');
            
            document.getElementById('predictPage').style.display = 'none';
            document.getElementById('startPage').style.display = 'flex';
            
            savedCards = [];
            currentX = null;
            currentY = null;
            isFlipped = false;
            isFlipping = false;
            stock = [];
            reveal = '10‚ô¶';
            startRotation = 0;
            lastTapTime = 0;
            
            console.log('‚úÖ Toutes les variables r√©initialis√©es');
        }
    </script>
</body>
</html>
