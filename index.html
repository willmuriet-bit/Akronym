<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>Akronym</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body, html {
            height: 100%;
            width: 100%;
            font-family: 'Arial', sans-serif;
            overflow: hidden;
            position: fixed;
        }

        body {
            background-image: url('background.jpg');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #startPage {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .rotation-container {
            position: relative;
            width: 300px;
            height: 300px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .comet-tail {            position: absolute;
            width: 300px;
            height: 300px;
            top: 50%;
            left: 50%;
            margin-top: -150px;
            margin-left: -150px;
            animation: rotateOnEdge 20s linear infinite;
            z-index: 15;
            pointer-events: none;
        }

        .comet-tail::before {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: conic-gradient(
                from 0deg,
                rgba(0, 255, 255, 1) 0deg,
                rgba(0, 255, 255, 0.9) 20deg,
                rgba(0, 255, 255, 0.7) 40deg,
                rgba(0, 191, 255, 0.5) 60deg,
                rgba(0, 191, 255, 0.3) 80deg,
                rgba(0, 191, 255, 0.15) 100deg,
                transparent 180deg
            );
            filter: blur(15px);
            transform: rotate(-90deg);
        }

        .comet-tail::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: conic-gradient(
                from 0deg,
                rgba(0, 255, 255, 1) 0deg,
                rgba(0, 255, 255, 0.8) 15deg,
                rgba(0, 191, 255, 0.5) 40deg,
                transparent 90deg
            );
            filter: blur(10px);
            transform: rotate(-90deg);
            opacity: 0.9;
        }
        .trail {
            position: absolute;
            width: 100%;
            height: 100%;
            border: 2px dashed rgba(0, 191, 255, 0.5);
            border-radius: 50%;
            box-sizing: border-box;
            z-index: 5;
            box-shadow: 0 0 15px rgba(0, 191, 255, 0.6);
        }

        .start-btn {
            position: relative;
            z-index: 10;
            background: linear-gradient(180deg, #4FD3FF 0%, #00BFFF 40%, #0080FF 100%);
            color: white;
            border: none;
            width: 300px;
            height: 300px;
            border-radius: 50%;
            font-size: 3rem;
            font-weight: bold;
            letter-spacing: 5px;
            cursor: pointer;
            box-shadow: 
                0 10px 30px rgba(0, 0, 0, 0.5),
                0 20px 60px rgba(0, 0, 0, 0.4),
                inset 0 -8px 15px rgba(0, 0, 0, 0.4),
                inset 0 8px 15px rgba(255, 255, 255, 0.5),
                inset 0 0 0 8px rgba(200, 200, 200, 0.8),
                inset 0 0 0 12px rgba(100, 100, 100, 0.6),
                inset 0 0 30px rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
            text-shadow: 0 3px 6px rgba(0, 0, 0, 0.4);
            outline: none;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
            -webkit-user-select: none;
        }

        .start-btn:hover {
            transform: scale(1.02);
            box-shadow: 
                0 12px 35px rgba(0, 0, 0, 0.6),
                0 25px 70px rgba(0, 0, 0, 0.5),
                inset 0 -8px 15px rgba(0, 0, 0, 0.4),
                inset 0 8px 15px rgba(255, 255, 255, 0.6),
                inset 0 0 0 8px rgba(200, 200, 200, 0.9),
                inset 0 0 0 12px rgba(100, 100, 100, 0.7),
                inset 0 0 40px rgba(255, 255, 255, 0.4);        }

        .start-btn:active {
            transform: scale(0.98);
        }

        .start-btn:focus,
        .start-btn:focus-visible {
            outline: none;
        }

        @keyframes rotateOnEdge {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        #keyboardPage {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('background.jpg');
            background-size: cover;
            background-position: center;
            z-index: 100;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            padding: 5px;
        }

        #displayArea {
            width: 95vw;
            max-width: 650px;
            min-height: 200px;
            background: rgba(0, 0, 0, 0.7);
            border: 3px solid rgba(0, 191, 255, 0.6);
            border-radius: 15px;
            margin: 10px 0;
            padding: 10px;
            font-size: 5rem;
            color: #00FFFF;
            text-align: center;
            box-shadow: 0 0 40px rgba(0, 191, 255, 0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;            gap: 5px;
            line-height: 1;
            overflow-x: auto;
            overflow-y: hidden;
        }

        .display-card {
            font-size: 16rem;
            display: inline-block;
            line-height: 1;
        }

        .display-card.last-card {
            cursor: pointer;
            filter: brightness(1.3);
            transition: all 0.2s ease;
        }

        .display-card.last-card:hover {
            transform: scale(1.1);
            filter: brightness(1.5);
        }

        .display-card.last-card:active {
            transform: scale(0.9);
        }

        .keyboard-container {
            background: rgba(0, 0, 0, 0.6);
            padding: 15px;
            border-radius: 15px;
            border: 2px solid rgba(0, 191, 255, 0.4);
            box-shadow: 0 0 50px rgba(0, 191, 255, 0.3);
            width: 95vw;
            max-width: 650px;
        }

        .keyboard-row {
            display: flex;
            justify-content: center;
            margin-bottom: 10px;
            gap: 10px;
            flex-wrap: wrap;
        }

        .key {
            background: rgba(0, 0, 0, 0.8);
            border: 2px solid #00BFFF;
            border-radius: 50%;
            color: white;            font-size: 2.8rem;
            font-weight: bold;
            width: 80px;
            height: 80px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 0 15px rgba(0, 191, 255, 0.3);
            position: relative;
            overflow: hidden;
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            outline: none;
            -webkit-tap-highlight-color: transparent;
            -webkit-focus-ring-color: transparent;
        }

        .key::before {
            content: '';
            position: absolute;
            width: 150%;
            height: 150%;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(0, 191, 255, 0.7) 0%, rgba(0, 191, 255, 0.3) 40%, transparent 70%);
            opacity: 0;
            transform: scale(0.3);
            transition: all 0.3s ease;
        }

        .key:hover::before {
            opacity: 1;
            transform: scale(1);
        }

        .key:hover {
            transform: scale(1.1);
            box-shadow: 0 0 40px rgba(0, 191, 255, 0.8), 0 0 60px rgba(0, 191, 255, 0.5);
        }

        .key:active {
            transform: scale(0.95);
        }

        .key:focus,
        .key:focus-visible {
            outline: none;
            box-shadow: 0 0 15px rgba(0, 191, 255, 0.3);        }

        .key.active-x {
            animation: pulseBlue 2s infinite;
        }

        .key.active-x::before {
            opacity: 1;
            transform: scale(1);
        }

        .key.active-x {
            box-shadow: 0 0 40px rgba(0, 191, 255, 0.8), 0 0 60px rgba(0, 191, 255, 0.5);
        }

        @keyframes pulseBlue {
            0%, 100% {
                box-shadow: 0 0 40px rgba(0, 191, 255, 0.8), 0 0 60px rgba(0, 191, 255, 0.5);
            }
            50% {
                box-shadow: 0 0 60px rgba(0, 191, 255, 1), 0 0 80px rgba(0, 191, 255, 0.7);
            }
        }

        .key.suit {
            font-size: 3.5rem;
        }

        .key.suit::before {
            content: '';
            position: absolute;
            width: 150%;
            height: 150%;
            border-radius: 50%;
            opacity: 0;
            transform: scale(0.3);
            transition: all 0.1s ease;
        }

        .key.suit:not(.hearts):not(.diamonds)::before {
            background: radial-gradient(circle, rgba(255, 255, 255, 0.9) 0%, rgba(255, 255, 255, 0.5) 40%, transparent 70%);
        }

        .key.suit:not(.hearts):not(.diamonds):active::before {
            opacity: 1;
            transform: scale(1);
        }

        .key.suit:not(.hearts):not(.diamonds):active {
            transform: scale(0.95);            box-shadow: 0 0 40px rgba(255, 255, 255, 0.9), 0 0 60px rgba(255, 255, 255, 0.6);
        }

        .key.hearts::before {
            background: radial-gradient(circle, rgba(255, 0, 0, 0.9) 0%, rgba(255, 0, 0, 0.5) 40%, transparent 70%);
        }

        .key.hearts:active::before {
            opacity: 1;
            transform: scale(1);
        }

        .key.hearts:active {
            transform: scale(0.95);
            box-shadow: 0 0 40px rgba(255, 0, 0, 0.9), 0 0 60px rgba(255, 0, 0, 0.6);
        }

        .key.diamonds::before {
            background: radial-gradient(circle, rgba(255, 0, 0, 0.9) 0%, rgba(255, 0, 0, 0.5) 40%, transparent 70%);
        }

        .key.diamonds:active::before {
            opacity: 1;
            transform: scale(1);
        }

        .key.diamonds:active {
            transform: scale(0.95);
            box-shadow: 0 0 40px rgba(255, 0, 0, 0.9), 0 0 60px rgba(255, 0, 0, 0.6);
        }

        .key.active-y {
            animation: pulseY 2s infinite;
        }

        .key.active-y::before {
            opacity: 1;
            transform: scale(1);
        }

        @keyframes pulseY {
            0%, 100% {
                box-shadow: 0 0 40px rgba(255, 255, 255, 0.8), 0 0 60px rgba(255, 255, 255, 0.5);
            }
            50% {
                box-shadow: 0 0 60px rgba(255, 255, 255, 1), 0 0 80px rgba(255, 255, 255, 0.7);
            }
        }

        .key.hearts.active-y {            animation: pulseYRed 2s infinite;
        }

        @keyframes pulseYRed {
            0%, 100% {
                box-shadow: 0 0 40px rgba(255, 0, 0, 0.8), 0 0 60px rgba(255, 0, 0, 0.5);
            }
            50% {
                box-shadow: 0 0 60px rgba(255, 0, 0, 1), 0 0 80px rgba(255, 0, 0, 0.7);
            }
        }

        .key.hearts {
            color: #FF0000;
            border-color: #FF0000;
            box-shadow: 0 0 15px rgba(255, 0, 0, 0.3);
        }

        .key.diamonds {
            color: #FF0000;
            border-color: #FF0000;
            box-shadow: 0 0 15px rgba(255, 0, 0, 0.3);
        }

        .key.predict {
            width: 180px;
            border-radius: 40px;
            font-size: 2rem;
            background: linear-gradient(180deg, rgba(0, 255, 100, 0.3) 0%, rgba(0, 200, 80, 0.3) 100%);
            border-color: #00FF64;
            color: #00FF64;
            transition: all 0.5s ease;
        }

        .key.predict.predict-giant {
            font-size: 3rem;
        }

        .key.predict.predict-active {
            background: linear-gradient(180deg, rgba(0, 255, 100, 0.6) 0%, rgba(0, 200, 80, 0.6) 100%);
            box-shadow: 0 0 40px rgba(0, 255, 100, 0.8), 0 0 60px rgba(0, 255, 100, 0.5);
            animation: pulsePredict 1.5s infinite;
        }

        @keyframes pulsePredict {
            0%, 100% {
                box-shadow: 0 0 40px rgba(0, 255, 100, 0.8), 0 0 60px rgba(0, 255, 100, 0.5);
            }
            50% {
                box-shadow: 0 0 60px rgba(0, 255, 100, 1), 0 0 80px rgba(0, 255, 100, 0.7);            }
        }

        .key.predict::before {
            background: radial-gradient(ellipse, rgba(0, 255, 100, 0.7) 0%, rgba(0, 255, 100, 0.3) 40%, transparent 70%);
        }

        .key.predict:hover {
            background: linear-gradient(180deg, rgba(0, 255, 100, 0.5) 0%, rgba(0, 200, 80, 0.5) 100%);
            box-shadow: 0 0 40px rgba(0, 255, 100, 0.8), 0 0 60px rgba(0, 255, 100, 0.5);
        }

        /* PAGE PREDICT */
        #predictPage {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('background.jpg');
            background-size: cover;
            background-position: center;
            z-index: 200;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        /* Animation de chargement */
        .loading-container {
            position: relative;
            width: 200px;
            height: 200px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .loading-ring {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 4px solid transparent;
            border-top-color: #00FFFF;
            border-right-color: #00BFFF;
            animation: spin 1s linear infinite;
        }
        .loading-ring:nth-child(2) {
            width: 70%;
            height: 70%;
            border-top-color: #00FF64;
            border-right-color: #00FFFF;
            animation: spin 1.5s linear infinite reverse;
        }

        .loading-ring:nth-child(3) {
            width: 40%;
            height: 40%;
            border-top-color: #FFD700;
            border-right-color: #00FF64;
            animation: spin 2s linear infinite;
        }

        .loading-particles {
            position: absolute;
            width: 100%;
            height: 100%;
            animation: spin 3s linear infinite;
        }

        .particle {
            position: absolute;
            width: 8px;
            height: 8px;
            background: #00FFFF;
            border-radius: 50%;
            box-shadow: 0 0 10px #00FFFF, 0 0 20px #00BFFF;
        }

        .particle:nth-child(1) { top: 0; left: 50%; animation: particleFloat 1s ease-in-out infinite; }
        .particle:nth-child(2) { top: 25%; right: 10%; animation: particleFloat 1.2s ease-in-out infinite 0.2s; background: #00FF64; }
        .particle:nth-child(3) { bottom: 25%; left: 10%; animation: particleFloat 1.4s ease-in-out infinite 0.4s; background: #FFD700; }
        .particle:nth-child(4) { bottom: 0; left: 50%; animation: particleFloat 1.1s ease-in-out infinite 0.6s; background: #00BFFF; }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        @keyframes particleFloat {
            0%, 100% { opacity: 0.3; transform: scale(0.5); }
            50% { opacity: 1; transform: scale(1.2); }
        }

        /* Carte dos - MODIFICATIONS DEMAND√âES */
        .golden-card {
            display: none;            font-size: 90rem; /* ‚úÖ Taille augment√©e (75rem ‚Üí 90rem) */
            color: #00FFFF;
            animation: zoomBreath 3s ease-in-out infinite;
            /* ‚úÖ Brume bleue SUPPRIM√âE (plus de filter drop-shadow) */
        }

        /* ‚úÖ Effet de grandissement r√©duit de moiti√© (1.3 ‚Üí 1.15) */
        @keyframes zoomBreath {
            0%, 100% { 
                transform: scale(1);
                opacity: 0.9;
            }
            50% { 
                transform: scale(1.15); /* Avant: 1.3, Maintenant: 1.15 (moiti√©) */
                opacity: 1;
            }
        }

        .back-btn {
            position: absolute;
            bottom: 30px;
            background: linear-gradient(180deg, #4FD3FF 0%, #00BFFF 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 30px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 0 20px rgba(0, 191, 255, 0.5);
            display: none;
        }

        .back-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 30px rgba(0, 191, 255, 0.8);
        }

        @media (max-width: 400px) {
            .key {
                width: min(80px, 18vw);
                height: min(80px, 18vw);
                font-size: min(2.8rem, 5vw);
            }
            .key.suit { font-size: min(3.5rem, 7vw); }
            .key.predict { width: min(180px, 40vw); font-size: min(2rem, 4vw); }
            .key.predict.predict-giant { font-size: min(3rem, 6vw); }
            #displayArea { min-height: 200px; gap: 5px; padding: 5px; }
            .display-card { font-size: min(16rem, 28vw); }
            .golden-card { font-size: min(90rem, 140vw); }        }
    </style>
</head>
<body>
    <div id="startPage">
        <div class="rotation-container">
            <div class="trail"></div>
            <button class="start-btn" onclick="goToKeyboard()">START</button>
            <div class="comet-tail" id="cometTail"></div>
        </div>
    </div>

    <div id="keyboardPage">
        <div id="displayArea"></div>
        
        <div class="keyboard-container">
            <div class="keyboard-row">
                <button class="key suit" data-suit="‚ô†" onclick="addChar('‚ô†')">‚ô†</button>
                <button class="key suit hearts" data-suit="‚ô•" onclick="addChar('‚ô•')">‚ô•</button>
                <button class="key suit" data-suit="‚ô£" onclick="addChar('‚ô£')">‚ô£</button>
                <button class="key suit diamonds" data-suit="‚ô¶" onclick="addChar('‚ô¶')">‚ô¶</button>
            </div>

            <div class="keyboard-row">
                <button class="key value-btn" data-value="A" onclick="addChar('A')">A</button>
                <button class="key value-btn" data-value="2" onclick="addChar('2')">2</button>
                <button class="key value-btn" data-value="3" onclick="addChar('3')">3</button>
                <button class="key value-btn" data-value="4" onclick="addChar('4')">4</button>
            </div>

            <div class="keyboard-row">
                <button class="key value-btn" data-value="5" onclick="addChar('5')">5</button>
                <button class="key value-btn" data-value="6" onclick="addChar('6')">6</button>
                <button class="key value-btn" data-value="7" onclick="addChar('7')">7</button>
                <button class="key value-btn" data-value="8" onclick="addChar('8')">8</button>
            </div>

            <div class="keyboard-row">
                <button class="key value-btn" data-value="9" onclick="addChar('9')">9</button>
                <button class="key value-btn" data-value="10" onclick="addChar('10')">10</button>
                <button class="key value-btn" data-value="J" onclick="addChar('J')">J</button>
                <button class="key value-btn" data-value="Q" onclick="addChar('Q')">Q</button>
            </div>

            <div class="keyboard-row">
                <button class="key value-btn" data-value="K" onclick="addChar('K')">K</button>
                <button class="key predict" id="predictBtn" onclick="predict()">PREDICT</button>
            </div>
        </div>
    </div>
    <!-- PAGE PREDICT -->
    <div id="predictPage">
        <div class="loading-container" id="loadingContainer">
            <div class="loading-ring"></div>
            <div class="loading-ring"></div>
            <div class="loading-ring"></div>
            <div class="loading-particles">
                <div class="particle"></div>
                <div class="particle"></div>
                <div class="particle"></div>
                <div class="particle"></div>
            </div>
        </div>
        <div class="golden-card" id="goldenCard">üÇ†</div>
        <button class="back-btn" id="backBtn" onclick="backToKeyboard()">RETOUR</button>
    </div>

    <script>
        var savedCards = [];
        var currentX = null;
        var currentY = null;
        var maxSavedCards = 4;
        var values = ['A', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K'];
        var suits = ['‚ô†', '‚ô•', '‚ô£', '‚ô¶'];
        var cometTailRotation = 0;

        var cardEmojis = {
            'A‚ô†': 'üÇ°', '2‚ô†': 'üÇ¢', '3‚ô†': 'üÇ£', '4‚ô†': 'üÇ§', '5‚ô†': 'üÇ•',
            '6‚ô†': 'üÇ¶', '7‚ô†': 'üÇß', '8‚ô†': 'üÇ®', '9‚ô†': 'üÇ©', '10‚ô†': 'üÇ™',
            'J‚ô†': 'üÇ´', 'Q‚ô†': 'üÇ≠', 'K‚ô†': 'üÇ¨',
            'A‚ô•': 'üÇ±', '2‚ô•': 'üÇ≤', '3‚ô•': 'üÇ≥', '4‚ô•': 'üÇ¥', '5‚ô•': 'üÇµ',
            '6‚ô•': 'üÇ∂', '7‚ô•': 'üÇ∑', '8‚ô•': 'üÇ∏', '9‚ô•': 'üÇπ', '10‚ô•': 'üÇ∫',
            'J‚ô•': 'üÇª', 'Q‚ô•': 'üÇΩ', 'K‚ô•': 'üÇº',
            'A‚ô£': 'üÉë', '2‚ô£': 'üÉí', '3‚ô£': 'üÉì', '4‚ô£': 'üÉî', '5‚ô£': 'üÉï',
            '6‚ô£': 'üÉñ', '7‚ô£': 'üÉó', '8‚ô£': 'üÉò', '9‚ô£': 'üÉô', '10‚ô£': 'üÉö',
            'J‚ô£': 'üÉõ', 'Q‚ô£': 'üÉù', 'K‚ô£': 'üÉú',
            'A‚ô¶': 'üÉÅ', '2‚ô¶': 'üÉÇ', '3‚ô¶': 'üÉÉ', '4‚ô¶': 'üÉÑ', '5‚ô¶': 'üÉÖ',
            '6‚ô¶': 'üÉÜ', '7‚ô¶': 'üÉá', '8‚ô¶': 'üÉà', '9‚ô¶': 'üÉâ', '10‚ô¶': 'üÉä',
            'J‚ô¶': 'üÉã', 'Q‚ô¶': 'üÉç', 'K‚ô¶': 'üÉå'
        };

        function trackCometRotation() {
            var cometTail = document.getElementById('cometTail');
            if (cometTail) {
                var style = window.getComputedStyle(cometTail);
                var matrix = style.transform;
                if (matrix !== 'none') {
                    var values_matrix = matrix.split('(')[1].split(')')[0].split(',');
                    var a = values_matrix[0];                    var b = values_matrix[1];
                    var angleInRadians = Math.atan2(b, a);
                    cometTailRotation = (angleInRadians * (180 / Math.PI) + 360) % 360;
                }
            }
            requestAnimationFrame(trackCometRotation);
        }

        trackCometRotation();

        function goToKeyboard() {
            var predictBtn = document.getElementById('predictBtn');
            if (predictBtn) {
                if (cometTailRotation >= 0 && cometTailRotation < 180) {
                    predictBtn.classList.add('predict-giant');
                } else {
                    predictBtn.classList.remove('predict-giant');
                }
            }
            document.getElementById('startPage').style.display = 'none';
            document.getElementById('keyboardPage').style.display = 'flex';
            savedCards = [];
            currentX = null;
            currentY = null;
            updateXButtonAnimation();
            updateYButtonAnimation();
            updateDisplay();
            updatePredictButton();
        }

        function updateXButtonAnimation() {
            var allValueBtns = document.querySelectorAll('.value-btn');
            for (var i = 0; i < allValueBtns.length; i++) {
                allValueBtns[i].classList.remove('active-x');
            }
            
            if (currentX !== null) {
                var activeBtn = document.querySelector('.value-btn[data-value="' + currentX + '"]');
                if (activeBtn) {
                    activeBtn.classList.add('active-x');
                }
            }
        }

        function updateYButtonAnimation() {
            var allSuitBtns = document.querySelectorAll('.key.suit');
            for (var i = 0; i < allSuitBtns.length; i++) {
                allSuitBtns[i].classList.remove('active-y');
            }
                        if (currentY !== null) {
                var activeBtn = document.querySelector('.key.suit[data-suit="' + currentY + '"]');
                if (activeBtn) {
                    activeBtn.classList.add('active-y');
                }
            }
        }

        // ‚úÖ CORRECTION FINALE: PREDICT bas√© sur cartes AFFICH√âES (pas sauvegard√©es)
        function updatePredictButton() {
            var predictBtn = document.getElementById('predictBtn');
            if (!predictBtn) return;
            
            // 1. Compter le total de cartes AFFICH√âES (sauvegard√©es + aper√ßu)
            var totalDisplayed = savedCards.length;
            
            // 2. Ajouter l'aper√ßu si existe (X+Y) et si place disponible
            if (currentX !== null && currentY !== null && savedCards.length < maxSavedCards) {
                totalDisplayed++;
            }
            
            // 3. V√©rifier s'il y a un DOUBLON dans l'aper√ßu
            var hasDuplicate = false;
            if (currentX !== null && currentY !== null) {
                var currentCard = currentX + currentY;
                if (savedCards.indexOf(currentCard) >= 0) {
                    hasDuplicate = true;
                }
            }
            
            console.log('üîÆ updatePredictButton - totalDisplayed:', totalDisplayed, 'hasDuplicate:', hasDuplicate, 'savedCards:', savedCards.length);
            
            // 4. Activer PREDICT seulement si : 4 cartes affich√©es ET pas de doublon
            if (totalDisplayed === 4 && !hasDuplicate) {
                predictBtn.style.pointerEvents = 'auto';
                predictBtn.style.opacity = '1';
                predictBtn.style.cursor = 'pointer';
                predictBtn.classList.add('predict-active');
                console.log('‚úÖ PREDICT ACTIV√â (4 cartes, pas de doublon)');
            } else {
                predictBtn.style.pointerEvents = 'auto';
                predictBtn.style.opacity = '0.5';
                predictBtn.style.cursor = 'not-allowed';
                predictBtn.classList.remove('predict-active');
                console.log('‚ùå PREDICT D√âSACTIV√â (total:', totalDisplayed, ', doublon:', hasDuplicate, ')');
            }
        }

        function updateDisplay() {
            var display = document.getElementById('displayArea');            var newContent = '';
            
            var hasPreview = (currentX !== null && currentY !== null && savedCards.length < maxSavedCards);
            var numSavedToShow = hasPreview ? Math.min(savedCards.length, maxSavedCards - 1) : Math.min(savedCards.length, maxSavedCards);
            
            for (var i = 0; i < numSavedToShow; i++) {
                var cardKey = savedCards[i];
                var cardEmoji = cardEmojis[cardKey] || cardKey;
                newContent += '<span class="display-card">' + cardEmoji + '</span>';
            }

            if (hasPreview) {
                var currentCard = currentX + currentY;
                var currentEmoji = cardEmojis[currentCard] || currentCard;
                var isDuplicate = (savedCards.indexOf(currentCard) >= 0);
                
                if (isDuplicate) {
                    newContent += '<span class="display-card last-card" style="filter: brightness(0.5);">' + currentEmoji + '</span>';
                } else {
                    newContent += '<span class="display-card last-card">' + currentEmoji + '</span>';
                }
            }

            if (display.innerHTML !== newContent) {
                display.innerHTML = newContent;
                attachClickListeners(savedCards.length > 0 && !hasPreview);
            }
        }

        function attachClickListeners(makeLastSavedClickable) {
            var display = document.getElementById('displayArea');
            var allCards = display.querySelectorAll('.display-card');
            
            for (var i = 0; i < allCards.length; i++) {
                allCards[i].classList.remove('last-card');
                allCards[i].onclick = null;
                allCards[i].ontouchstart = null;
            }
            
            if (allCards.length > 0) {
                var lastCard = allCards[allCards.length - 1];
                lastCard.classList.add('last-card');
                lastCard.onclick = deleteLastCard;
                lastCard.ontouchstart = function(e) {
                    e.preventDefault();
                    deleteLastCard();
                };
            }
        }
        function deleteLastCard() {
            console.log('üóëÔ∏è deleteLastCard - Avant:', {savedCards: savedCards.slice(), currentX: currentX, currentY: currentY});
            
            if (currentX !== null && currentY !== null) {
                console.log('‚Üí Carte en cours effac√©e');
            } else if (savedCards.length > 0) {
                savedCards.pop();
                console.log('‚Üí Carte sauvegard√©e supprim√©e');
            }
            
            currentX = null;
            currentY = null;
            updateXButtonAnimation();
            updateYButtonAnimation();
            updatePredictButton(); // ‚úÖ Met √† jour PREDICT apr√®s suppression
            console.log('‚Üí currentX = null, currentY = null');
            
            updateDisplay();
        }

        function addChar(char) {
            console.log('üéØ addChar - char:', char, 'currentX:', currentX, 'currentY:', currentY, 'savedCards:', savedCards.length);
            
            if (values.indexOf(char) >= 0) {
                // C'est une valeur (X)
                if (currentX !== null && currentY !== null) {
                    // Une carte compl√®te (X+Y) existe ‚Üí la sauvegarder
                    var cardKey = currentX + currentY;
                    if (savedCards.indexOf(cardKey) < 0 && savedCards.length < maxSavedCards) {
                        savedCards.push(cardKey);
                        console.log('‚úÖ Carte sauvegard√©e: ' + cardKey, '(total:', savedCards.length, ')');
                    } else {
                        console.log('‚ùå Doublon ou plein: ' + cardKey);
                    }
                }
                // Nouveau X (dans tous les cas)
                currentX = char;
                currentY = null;
                
                updateXButtonAnimation();
                updateYButtonAnimation();
                updatePredictButton(); // ‚úÖ Met √† jour PREDICT
                updateDisplay();
                
            } else if (suits.indexOf(char) >= 0) {
                // C'est une enseigne (Y)
                if (currentX !== null) {
                    currentY = char;
                    updateXButtonAnimation();
                    updateYButtonAnimation();                    updatePredictButton(); // ‚úÖ Met √† jour PREDICT
                    updateDisplay();
                }
            }
        }

        function predict() {
            console.log('üîÆ predict() appel√© - savedCards.length:', savedCards.length);
            
            // V√©rification finale de s√©curit√©
            var totalDisplayed = savedCards.length;
            if (currentX !== null && currentY !== null && savedCards.length < maxSavedCards) {
                totalDisplayed++;
            }
            var hasDuplicate = false;
            if (currentX !== null && currentY !== null) {
                var currentCard = currentX + currentY;
                if (savedCards.indexOf(currentCard) >= 0) {
                    hasDuplicate = true;
                }
            }
            
            if (totalDisplayed !== 4 || hasDuplicate) {
                console.log('‚ùå PREDICT refus√©: totalDisplayed:', totalDisplayed, 'hasDuplicate:', hasDuplicate);
                return;
            }
            
            console.log('‚úÖ PREDICT accept√©!');
            
            // Ouvrir page PREDICT
            document.getElementById('keyboardPage').style.display = 'none';
            document.getElementById('predictPage').style.display = 'flex';
            
            // Afficher loading
            document.getElementById('loadingContainer').style.display = 'flex';
            document.getElementById('goldenCard').style.display = 'none';
            document.getElementById('backBtn').style.display = 'none';
            
            // Animation 4 secondes
            setTimeout(function() {
                document.getElementById('loadingContainer').style.display = 'none';
                document.getElementById('goldenCard').style.display = 'block';
                document.getElementById('backBtn').style.display = 'block';
                console.log('‚úÖ Carte dos affich√©e!');
            }, 4000);
        }

        function backToKeyboard() {
            document.getElementById('predictPage').style.display = 'none';
            document.getElementById('keyboardPage').style.display = 'flex';            updateDisplay();
        }
    </script>
</body>
</html>
